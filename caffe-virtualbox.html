<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Try Caffe pre-installed on a VirtualBox image</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="./caffe-virtualbox.html" rel="canonical" />
  <!-- Feed -->

  <link href="./theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="./theme/css/code_blocks/github.css" rel="stylesheet">


  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->



    <meta name="description" content="A previous post showed beginners how to try out deep learning libraries by using an Amazon Machine Image (AMI) pre-installed with deep...">

    <meta name="author" content="Cathy Yeh">

    <meta name="tags" content="Caffe">
    <meta name="tags" content="deep learning">
    <meta name="tags" content="Jupyter">
    <meta name="tags" content="cloud">




<!-- Open Graph -->
<meta property="og:site_name" content="EFAVDB"/>
<meta property="og:title" content="Try Caffe pre-installed on a VirtualBox image"/>
<meta property="og:description" content="A previous post showed beginners how to try out deep learning libraries by using an Amazon Machine Image (AMI) pre-installed with deep..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="./caffe-virtualbox.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2016-03-22 15:02:00-07:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="./author/cathy-yeh.html">
<meta property="article:section" content="Tools"/>
<meta property="article:tag" content="Caffe"/>
<meta property="article:tag" content="deep learning"/>
<meta property="article:tag" content="Jupyter"/>
<meta property="article:tag" content="cloud"/>
<meta property="og:image" content="./theme/images/post-bg.jpg">

<!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@efavdb">
    <meta name="twitter:title" content="Try Caffe pre-installed on a VirtualBox image">
    <meta name="twitter:url" content="./caffe-virtualbox.html">

        <meta name="twitter:image:src" content="./theme/images/post-bg.jpg">

      <meta name="twitter:description" content="A previous post showed beginners how to try out deep learning libraries by using an Amazon Machine Image (AMI) pre-installed with deep...">

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Try Caffe pre-installed on a VirtualBox image",
  "headline": "Try Caffe pre-installed on a VirtualBox image",
  "datePublished": "2016-03-22 15:02:00-07:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Cathy Yeh",
    "url": "./author/cathy-yeh.html"
  },
  "image": "./theme/images/post-bg.jpg",
  "url": "./caffe-virtualbox.html",
  "description": "A previous post showed beginners how to try out deep learning libraries by using an Amazon Machine Image (AMI) pre-installed with deep..."
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>
          <li><a href="/" role="presentation">Home</a></li>
          <li><a href="/pages/about.html" role="presentation">About & Consulting</a></li>
          <li><a href="/archives.html" role="presentation">Archive</a></li>
          <li><a href="/tags.html" role="presentation">Tags</a></li>
          <li><a href="/pages/linselect.html" role="presentation">linselect - feature selection</a></li>


    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" >
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="./" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Try Caffe pre-installed on a VirtualBox image</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="./author/cathy-yeh.html">Cathy Yeh</a>
            | <time datetime="Tue 22 March 2016">Tue 22 March 2016</time>
        </span>
        <!-- TODO : Modified check -->
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <p>A previous <a href="http://efavdb.com/deep-learning-with-jupyter-on-aws/">post</a> showed beginners how to try out deep learning libraries by</p>
<ol>
<li>using an Amazon Machine Image (AMI) pre-installed with deep learning libraries</li>
<li>setting up a Jupyter notebook server to play with said libraries</li>
</ol>
<p>If you have VirtualBox and <a href="https://www.vagrantup.com/">Vagrant</a>, you can follow a similar procedure on your own computer. The advantage is that you can develop locally, then deploy on an expensive AWS EC2 gpu instance when your scripts are ready.  </p>
<p>For example, <a href="http://caffe.berkeleyvision.org/">Caffe</a>, the machine vision framework, allows you to seamlessly transition between cpu- and gpu-mode, and is available as a <a href="https://atlas.hashicorp.com/malthejorgensen/boxes/caffe-deeplearning">vagrant box</a> running Ubuntu 14.04 (<a href="#virtualization">**</a>64-bit), with Caffe pre-installed.</p>
<p>To add the box, type on the command line:<br>
<code>vagrant box add malthejorgensen/caffe-deeplearning</code></p>
<p>If you don't already have VirtualBox and Vagrant installed, you can find instructions online, or look at my <a href="#vagrant_install">dotfiles</a> to get an idea.</p>
<hr>
<h2>Gotchas</h2>
<h3>SSH authentication failure</h3>
<p>For me, the box had the wrong public key in <code>/home/vagrant/.ssh/authorized_keys file</code>, which gave me “authentication failure” upon starting up the box with <code>vagrant up</code>. This was fixed by:</p>
<p>Manually ssh into the box: <code>vagrant ssh</code>.</p>
<p>Then type (key taken from <a href="https://raw.githubusercontent.com/mitchellh/vagrant/master/keys/vagrant.pub">here</a>):</p>
<p>[code language="bash"]<br>
echo "ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22WDkTkyrtvp9eWW6A8YVr+kz4TjGYe7gHzIw+niNltGEFHzD8+v1I2YJ6oXevct1YeS0o9HZyN1Q9qgCgzUFtdOKLv6IedplqoPkcmF0aYet2PkEDo3MlTBckFXPITAMzF8dJSIFo9D8HfdOV0IAdx4O7PtixWKn5y2hMNG0zQPyUecp4pzC6kivAIhyfHilFR61RGL+GPXQ2MWZWFYbAGjyiYJnAmCP3NOTd0jMZEnDkbUvxhMmBYSdETk1rRgm+R4LOzFUGaHqHDLKLX+FIPKcF96hrucXzcWyLbIbEgE98OHlnVYCzRdK8jlqm8tehUc9c9WhQ== vagrant insecure public key" &gt; ~/.ssh/authorized_keys  </p>
<div class="highlight"><pre><span></span><span class="nf">Log</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">box</span><span class="p">,</span><span class="w"> </span><span class="n">reload</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="err">`</span><span class="n">vagrant</span><span class="w"> </span><span class="n">reload</span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">hopefully</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">fixed</span><span class="p">.</span><span class="w"></span>

<span class="err">###</span><span class="w"> </span><span class="n">Jupyter</span><span class="w"> </span><span class="n">notebook</span><span class="w"> </span><span class="n">server</span><span class="w"></span>

<span class="k">By</span><span class="w"> </span><span class="k">default</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">notebook</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">8003</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">starts</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">vagrant</span><span class="o">/</span><span class="n">caffe</span><span class="o">/</span><span class="n">examples</span><span class="w"> </span><span class="n">directory</span><span class="p">,</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">conjunction</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">forwarding</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Vagrant</span><span class="w"> </span><span class="k">file</span><span class="err">:</span><span class="w">  </span>
<span class="err">`</span><span class="n">config</span><span class="p">.</span><span class="n">vm</span><span class="p">.</span><span class="n">network</span><span class="w"> </span><span class="ss">&quot;forwarded_port&quot;</span><span class="p">,</span><span class="w"> </span><span class="nl">guest</span><span class="p">:</span><span class="w"> </span><span class="mi">8003</span><span class="p">,</span><span class="w"> </span><span class="k">host</span><span class="err">:</span><span class="w"> </span><span class="mi">8003</span><span class="err">`</span><span class="w">  </span>
<span class="k">With</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">setup</span><span class="p">,</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="err">`</span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="nl">localhost</span><span class="p">:</span><span class="mi">8003</span><span class="err">`</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">browser</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">vagrant</span><span class="o">/</span><span class="n">caffe</span><span class="o">/</span><span class="n">examples</span><span class="p">.</span><span class="w"></span>

<span class="n">The</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">setup</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">vagrant</span><span class="o">/</span><span class="n">caffe</span><span class="o">/</span><span class="n">examples</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">prefer</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">my</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">jupyter</span><span class="w"> </span><span class="n">notebook</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">8888</span><span class="w"> </span><span class="p">(</span><span class="n">allowing</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="n">forwarding</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">8888</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Vagrantfile</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">well</span><span class="p">)</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="k">start</span><span class="w"> </span><span class="n">up</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">vagrant</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">wherever</span><span class="w"> </span><span class="n">I</span><span class="err">&#39;</span><span class="n">m</span><span class="w"> </span><span class="n">working</span><span class="p">.</span><span class="w"> </span><span class="k">To</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="n">this</span><span class="p">,</span><span class="w"></span>

<span class="nf">Log</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nl">box</span><span class="p">:</span><span class="w"> </span><span class="err">`</span><span class="n">vagrant</span><span class="w"> </span><span class="n">ssh</span><span class="err">`</span><span class="w"></span>

<span class="k">Then</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">notebook</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="err">`</span><span class="o">~/</span><span class="p">.</span><span class="n">jupyter</span><span class="o">/</span><span class="n">jupyter_notebook_config</span><span class="p">.</span><span class="n">py</span><span class="err">`</span><span class="w"> </span><span class="n">containing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">following</span><span class="w"> </span><span class="nl">lines</span><span class="p">:</span><span class="w"></span>
</pre></div>


<p>c.NotebookApp.ip = '*'<br>
c.NotebookApp.open_browser = False<br>
c.NotebookApp.port = 8888<br>
```</p>
<h3>Vagrantfile</h3>
<p>Here's the vagrant file that worked for me:  </p>
<hr>
<ul>
<li>Scripts to <a href="https://github.com/frangipane/.dotfiles/blob/master/install/apt-get.sh">install Virtualbox</a> (line 31 and onwards) and <a href="https://github.com/frangipane/.dotfiles/blob/master/install/install-vagrant.sh">install Vagrant</a>.</li>
</ul>
<p>** This is a 64-bit box, so you need to have Intel VT-x enabled in your BIOS.</p>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Try Caffe pre-installed on a VirtualBox image&amp;url=./caffe-virtualbox.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=./caffe-virtualbox.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=./caffe-virtualbox.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="./tag/caffe.html">Caffe</a><a href="./tag/deep-learning.html">deep learning</a><a href="./tag/jupyter.html">Jupyter</a><a href="./tag/cloud.html">cloud</a>                </aside>

                <div class="clear"></div>

                <aside class="post-author">


                        <figure class="post-author-avatar">
                            <img src=".//wp-content/uploads/2014/12/cathy_photo.jpg" alt="Cathy Yeh" />
                        </figure>
                    <div class="post-author-bio">
                        <h4 class="post-author-name"><a href="./author/cathy-yeh.html">Cathy Yeh</a></h4>
                            <p class="post-author-about">Cathy Yeh got a PhD at UC Santa Barbara studying soft-matter/polymer physics. She is currently looking to transition to a career in data science after wrapping up work with the translational modeling group in a pharmaceutical company in San Diego. She enjoys mining big data and big ice cream and seeing how both can help make the world a better place.</p>
                        <!-- Social linkes in alphabet order. -->
                    </div>
                    <div class="clear"></div>
                </aside>

                </section>


                <aside class="post-nav">
                    <a class="post-nav-next" href="./bonferroni-correction-for-multiple-pairwise-comparison-tests.html">
                        <section class="post-nav-teaser">
                            <i class="ic ic-arrow-left"></i>
                                <h2 class="post-nav-title">Improved Bonferroni correction factors for multiple pairwise comparisons</h2>
                            <p class="post-nav-excerpt">A common task in applied statistics is the pairwise comparison of the responses of...</p>
                        </section>
                    </a>
                    <a class="post-nav-prev" href="./deep-learning-with-jupyter-on-aws.html">
                        <section class="post-nav-teaser">
                            <i class="ic ic-arrow-right"></i>
                                <h2 class="post-nav-title">Start deep learning with Jupyter notebooks in the cloud</h2>
                            <p class="post-nav-excerpt">Want a quick and easy way to play around with deep learning libraries? Puny GPU got...</p>
                        </section>
                    </a>
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">
        </section>
      </div>
    </footer>
  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script type="text/javascript" src="./theme/js/script.js"></script>

</body>
</html>