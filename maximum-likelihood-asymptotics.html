<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Maximum-likelihood asymptotics</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="./maximum-likelihood-asymptotics.html" rel="canonical" />
  <!-- Feed -->

  <link href="./theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="./theme/css/code_blocks/github.css" rel="stylesheet">


  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->



    <meta name="description" content="In this post, we review two facts about maximum-likelihood estimators: 1) They are consistent, meaning that they converge to the correct...">

    <meta name="author" content="Jonathan Landy">





<!-- Open Graph -->
<meta property="og:site_name" content="EFAVDB"/>
<meta property="og:title" content="Maximum-likelihood asymptotics"/>
<meta property="og:description" content="In this post, we review two facts about maximum-likelihood estimators: 1) They are consistent, meaning that they converge to the correct..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="./maximum-likelihood-asymptotics.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2015-12-30 00:01:00-08:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="./author/jonathan-landy.html">
<meta property="article:section" content="Statistics"/>
<meta property="og:image" content="./theme/images/post-bg.jpg">

<!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@efavdb">
    <meta name="twitter:title" content="Maximum-likelihood asymptotics">
    <meta name="twitter:url" content="./maximum-likelihood-asymptotics.html">

        <meta name="twitter:image:src" content="./theme/images/post-bg.jpg">

      <meta name="twitter:description" content="In this post, we review two facts about maximum-likelihood estimators: 1) They are consistent, meaning that they converge to the correct...">

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Maximum-likelihood asymptotics",
  "headline": "Maximum-likelihood asymptotics",
  "datePublished": "2015-12-30 00:01:00-08:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Jonathan Landy",
    "url": "./author/jonathan-landy.html"
  },
  "image": "./theme/images/post-bg.jpg",
  "url": "./maximum-likelihood-asymptotics.html",
  "description": "In this post, we review two facts about maximum-likelihood estimators: 1) They are consistent, meaning that they converge to the correct..."
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>
          <li><a href="/" role="presentation">Home</a></li>
          <li><a href="/pages/about.html" role="presentation">About & Consulting</a></li>
          <li><a href="/archives.html" role="presentation">Archive</a></li>
          <li><a href="/tags.html" role="presentation">Tags</a></li>
          <li><a href="/pages/linselect.html" role="presentation">linselect - feature selection</a></li>


    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" >
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="./" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Maximum-likelihood asymptotics</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="./author/jonathan-landy.html">Jonathan Landy</a>
            | <time datetime="Wed 30 December 2015">Wed 30 December 2015</time>
        </span>
        <!-- TODO : Modified check -->
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <p>In this post, we review two facts about maximum-likelihood estimators: 1) They are consistent, meaning that they converge to the correct values given a large number of samples, <span class="math">\(N\)</span>, and 2) They satisfy the <a href="http://efavdb.com/multivariate-cramer-rao-bound/">Cramer-Rao</a> lower bound for unbiased parameter estimates in this same limit -- that is, they have the lowest possible variance of any unbiased estimator, in the <span class="math">\(N\gg 1\)</span> limit.</p>
<h3>Introduction</h3>
<p>We begin with a simple example maximum-likelihood inference problem: Suppose one has obtained <span class="math">\(N\)</span> independent samples <span class="math">\(\{x_1, x_2, \ldots, x_N\}\)</span> from a Gaussian distribution of unknown mean <span class="math">\(\mu\)</span> and variance <span class="math">\(\sigma^2\)</span>. In order to obtain a maximum-likelihood estimate for these parameters, one asks which <span class="math">\(\hat{\mu}\)</span> and <span class="math">\(\hat{\sigma}^2\)</span> would be most likely to generate the samples observed. To find these, we first write down the probability of observing the samples, given our model. This is simply<br>
</p>
<div class="math">$$  
P(\{x_1, x_2, \ldots, x_N\} \vert \mu, \sigma^2) = \exp\left [ \sum_{i=1}^N \left (-\frac{1}{2} \log (2 \pi \sigma^2) -\frac{1}{2 \sigma^2} (x_i - \mu)^2\right ) \right ]. \tag{1} \label{1}  
$$</div>
<p><br>
To obtain the maximum-likelihood estimates, we maximize (\ref{1}): Setting its derivatives with respect to <span class="math">\(\mu\)</span> and <span class="math">\(\sigma^2\)</span> to zero and solving gives<br>
</p>
<div class="math">\begin{align}\label{mean}  
\hat{\mu} &amp;= \frac{1}{N} \sum_i x_i \tag{2} \\  
\hat{\sigma}^2 &amp;= \frac{1}{N} \sum_i (x_i - \hat{\mu})^2. \tag{3} \label{varhat}  
\end{align}</div>
<p><br>
These are mean and variance values that would be most likely to generate our observation set <span class="math">\(\{x_i\}\)</span>. Our solutions show that they are both functions of the random observation set. Because of this, <span class="math">\(\hat{\mu}\)</span> and <span class="math">\(\hat{\sigma}^2\)</span> are themselves random variables, changing with each sample set that happens to be observed. Their distributions can be characterized by their mean values, variances, etc.</p>
<p>The average squared error of a parameter estimator is determined entirely by its bias and variance -- see eq (2) of <a href="http://efavdb.com/bayesian-linear-regression/">prior post</a>. Now, one can show that the <span class="math">\(\hat{\mu}\)</span> estimate of (\ref{mean}) is unbiased, but this is not the case for the variance estimator (\ref{varhat}) -- one should (famously) divide by <span class="math">\(N-1\)</span> instead of <span class="math">\(N\)</span> here to obtain an unbiased estimator<span class="math">\(^1\)</span>. This shows that maximum-likelihood estimators need not be unbiased. Why then are they so popular? One reason is that these estimators are guaranteed to be unbiased when <span class="math">\(N\)</span>, the sample size, is large. Further, in this same limit, these estimators achieve the minimum possible variance for any unbiased parameter estimate -- as set by the fundamental <a href="http://efavdb.com/multivariate-cramer-rao-bound/">Cramer-Rao</a> bound. The purpose of this post is to review simple proofs of these latter two facts about maximum-likelihood estimators<span class="math">\(^2\)</span>.</p>
<h3>Consistency</h3>
<p>Let <span class="math">\(P(x \vert \theta^*)\)</span> be some distribution characterized by a parameter <span class="math">\(\theta^*\)</span> that is unknown. We will show that the maximum-likelihood estimator converges to <span class="math">\(\theta^*\)</span> when <span class="math">\(N\)</span> is large: As in (\ref{1}), the maximum-likelihood solution is that <span class="math">\(\theta\)</span> that maximizes<br>
</p>
<div class="math">$$\tag{4} \label{4}  
J \equiv \frac{1}{N}\sum_{i=1}^N \log P(x_i \vert \theta),  
$$</div>
<p><br>
where the <span class="math">\(\{x_i\}\)</span> are the independent samples taken from <span class="math">\(P(x \vert \theta^*)\)</span>. By the law of large numbers, when <span class="math">\(N\)</span> is large, this average over the samples converges to its population mean. In other words,<br>
</p>
<div class="math">$$\tag{5}  
\lim_{N \to \infty}J \rightarrow \int_x P(x \vert \theta^*) \log P(x \vert \theta) dx.  
$$</div>
<p><br>
We will show that <span class="math">\(\theta^*\)</span> is the <span class="math">\(\theta\)</span> value that maximizes the above. We can do this directly, writing<br>
</p>
<div class="math">$$  
\begin{align}  
J(\theta) - J(\theta^*) &amp; = \int_x P(x \vert \theta^*) \log \left ( \frac{P(x \vert \theta) }{P(x \vert \theta^*)}\right) \\  
&amp; \leq \int_x P(x \vert \theta^*) \left ( \frac{P(x \vert \theta) }{P(x \vert \theta^*)} - 1 \right) \\  
&amp; = \int_x P(x \vert \theta) - P(x \vert \theta^*) = 1 - 1 = 0. \tag{6} \label{6}  
\end{align}  
$$</div>
<p><br>
Here, we have used <span class="math">\(\log t \leq t-1\)</span> in the second line. Rearranging the above shows that <span class="math">\(J(\theta^*) \geq J(\theta)\)</span> for all <span class="math">\(\theta\)</span> -- when <span class="math">\(N \gg 1\)</span>, meaning that <span class="math">\(J\)</span> is maximized at <span class="math">\(\theta^*\)</span>. That is, the maximum-likelihood estimator <span class="math">\(\hat{\theta} \to \theta^*\)</span> in this limit<span class="math">\(^3\)</span>.</p>
<h3>Optimal variance</h3>
<p>To derive the variance of a general maximum-likelihood estimator, we will see how its average value changes upon introduction of a small Bayesian prior, <span class="math">\(P(\theta) \sim \exp(\Lambda \theta)\)</span>. The trick will be to evaluate the change in two separate ways -- this takes a few lines, but is quite straightforward. In the first approach, we do a direct maximization: The quantity to be maximized is now<br>
</p>
<div class="math">$$ \label{7}  
J = \sum_{i=1}^N \log P(x_i \vert \theta) + \Lambda \theta. \tag{7}  
$$</div>
<p><br>
Because we take <span class="math">\(\Lambda\)</span> small, we can use a Taylor expansion to find the new solution, writing<br>
</p>
<div class="math">$$ \label{8}  
\hat{\theta} = \theta^* + \theta_1 \Lambda + O(\Lambda^2). \tag{8}  
$$</div>
<p><br>
Setting the derivative of (\ref{7}) to zero, with <span class="math">\(\theta\)</span> given by its value in (\ref{8}), we obtain<br>
</p>
<div class="math">$$  
\sum_{i=1}^N \partial_{\theta} \left . \log P(x_i \vert \theta) \right \vert_{\theta^*} + \sum_{i=1}^N \partial_{\theta}^2 \left . \log P(x_i \vert \theta) \right \vert_{\theta^*} \times \theta_1 \Lambda + \Lambda + O(\Lambda^2) = 0. \tag{9} \label{9}  
$$</div>
<p><br>
The first term here goes to zero at large <span class="math">\(N\)</span>, as above. Setting the terms at <span class="math">\(O(\Lambda^1)\)</span> to zero gives<br>
</p>
<div class="math">$$  
\theta_1 = - \frac{1}{ \sum_{i=1}^N \partial_{\theta}^2 \left . \log P(x_i \vert \theta) \right \vert_{\theta^*} }. \tag{10} \label{10}  
$$</div>
<p><br>
Plugging this back into (\ref{8}) gives the first order correction to <span class="math">\(\hat{\theta}\)</span> due to the perturbation. Next, as an alternative approach, we evaluate the change in <span class="math">\(\theta\)</span> by maximizing the <span class="math">\(P(\theta)\)</span> distribution, expanding about its unperturbed global maximum, <span class="math">\(\theta^*\)</span>: We write, formally,<br>
</p>
<div class="math">$$\tag{11} \label{11}  
P(\theta) = \exp\left [ - a_0 - a_2 (\theta - \theta^*)^2 - a_3 (\theta - \theta^*)^3 + \ldots + \Lambda \theta \right].  
$$</div>
<p><br>
Differentiating to maximize (\ref{11}), and again assuming a solution of form (\ref{8}), we obtain<br>
</p>
<div class="math">$$\label{12} \tag{12}  
-2 a_2 \times \theta_1 \Lambda + \Lambda + O(\Lambda^2) = 0 \ \ \to \ \ \theta_1 = \frac{1}{2 a_2}.  
$$</div>
<p><br>
We now require consistency between our two approaches, equating (\ref{10}) and (\ref{12}). This gives an expression for <span class="math">\(a_2\)</span>. Plugging this back into (\ref{11}) then gives (for the unperturbed distribution)<br>
</p>
<div class="math">$$\tag{13} \label{13}  
P(\theta) = \mathcal{N} \exp \left [ N \frac{ \langle \partial_{\theta}^2 \left . \log P(x, \theta) \right \vert_{\theta^*} \rangle }{2} (\theta - \theta^*)^2 + \ldots \right].  
$$</div>
<p><br>
Using this Gaussian approximation<span class="math">\(^4\)</span>, we can now read off the large <span class="math">\(N\)</span> variance of <span class="math">\(\hat{\theta}\)</span> as<br>
</p>
<div class="math">$$\tag{14} \label{14}  
var(\hat{\theta}) = - \frac{1}{N} \times \frac{1}{\langle \partial_{\theta}^2 \left . \log P(x, \theta) \right \vert_{\theta^*} \rangle }.  
$$</div>
<p><br>
This is the lowest possible value for any unbiased estimator, as set by the Cramer-Rao bound. The proof shows that maximum-likelihood estimators always saturate this bound, in the large <span class="math">\(N\)</span> limit -- a remarkable result. We discuss the intuitive meaning of the Cramer-Rao bound in a <a href="http://efavdb.com/multivariate-cramer-rao-bound/">prior post</a>.</p>
<h3>Footnotes</h3>
<p>[1] To see that (\ref{varhat}) is biased, we just need to evaluate the average of <span class="math">\(\sum_i (x_i - \hat{\mu})^2\)</span>. This is</p>
<div class="math">$$  
\overline{\sum_i x_i^2 - 2 \sum_{i,j} \frac{x_i x_j}{N} + \sum_{i,j,k} \frac{x_j x_k}{N^2}} = N \overline{x^2} - (N-1) \overline{x}^2 - \overline{x^2} \\  
= (N-1) \left ( \overline{x^2} - \overline{x}^2 \right) \equiv (N-1) \sigma^2.  
$$</div>
<p><br>
Dividing through by <span class="math">\(N\)</span>, we see that <span class="math">\(\overline{\hat{\sigma}^2} = \left(\frac{N-1}{N}\right)\sigma^2\)</span>. The deviation from the true variance <span class="math">\(\sigma^2\)</span> goes to zero at large <span class="math">\(N\)</span>, but is non-zero for any finite <span class="math">\(N\)</span>: The estimator is biased, but the bias goes to zero at large <span class="math">\(N\)</span>.</p>
<p>[2] The consistency proof is taken from lecture notes by D. Panchenko, see <a href="http://ocw.mit.edu/courses/mathematics/18-443-statistics-for-applications-fall-2006/lecture-notes/lecture3.pdf">here</a>. Professor Panchenko is quite famous for having proven the correctness of the Parisi ansatz in replica theory. Our variance proof is original -- please let us know if you have seen it elsewhere. Note that it can also be easily extended to derive the covariance matrix of a set of maximum-likelihood estimators that are jointly distributed -- we cover only the scalar case here, for simplicity.</p>
<p>[3] The proof here actually only shows that there is no <span class="math">\(\theta\)</span> that gives larger likelihood than <span class="math">\(\theta^*\)</span> in the large <span class="math">\(N\)</span> limit. However, for some problems, it is possible that more than one <span class="math">\(\theta\)</span> maximizes the likelihood. A trivial example is given by the case where the distribution is actually only a function of <span class="math">\((\theta - \theta_0)^2\)</span>. In this case, both values <span class="math">\(\theta_0 \pm (\theta^* - \theta_0)\)</span> will necessarily maximize the likelihood.</p>
<p>[4] It's a simple matter to carry this analysis further, including the cubic and higher order terms in the expansion (\ref{11}). These lead to correction terms for (\ref{14}), smaller in magnitude than that given there. These terms become important when <span class="math">\(N\)</span> decreases in magnitude.</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Maximum-likelihood asymptotics&amp;url=./maximum-likelihood-asymptotics.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=./maximum-likelihood-asymptotics.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=./maximum-likelihood-asymptotics.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>


                <div class="clear"></div>

                <aside class="post-author">


                        <figure class="post-author-avatar">
                            <img src=".//wp-content/uploads/2014/12/JonathanLinkedIn.jpg" alt="Jonathan Landy" />
                        </figure>
                    <div class="post-author-bio">
                        <h4 class="post-author-name"><a href="./author/jonathan-landy.html">Jonathan Landy</a></h4>
                            <p class="post-author-about">Jonathan grew up in the midwest and then went to school at Caltech and UCLA. Following this, he did two postdocs, one at UCSB and one at UC Berkeley.  His academic research focused primarily on applications of statistical mechanics, but his professional passion has always been in the mastering, development, and practical application of slick math methods/tools. He worked as a data-scientist at Square for four years and is now working on a quantitative investing startup.</p>
                        <!-- Social linkes in alphabet order. -->
                    </div>
                    <div class="clear"></div>
                </aside>

                </section>


                <aside class="post-nav">
                    <a class="post-nav-next" href="./independent-component-analysis.html">
                        <section class="post-nav-teaser">
                            <i class="ic ic-arrow-left"></i>
                                <h2 class="post-nav-title">Independent component analysis</h2>
                            <p class="post-nav-excerpt">Two microphones are placed in a room where two conversations are taking place...</p>
                        </section>
                    </a>
                    <a class="post-nav-prev" href="./principal-component-analysis.html">
                        <section class="post-nav-teaser">
                            <i class="ic ic-arrow-right"></i>
                                <h2 class="post-nav-title">Principal component analysis</h2>
                            <p class="post-nav-excerpt">We review the two essentials of principal component analysis ("PCA"): 1) The principal...</p>
                        </section>
                    </a>
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">
        </section>
      </div>
    </footer>
  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script type="text/javascript" src="./theme/js/script.js"></script>

</body>
</html>