<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Machine learning with wearable sensors</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="./machine-learning-with-wearable-sensors.html" rel="canonical" />
  <!-- Feed -->

  <link href="./theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="./theme/css/code_blocks/github.css" rel="stylesheet">


  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->



    <meta name="description" content="A guest post, contributed by Damien Ramunno-Johnson (LinkedIn, bio-sketch) Follow @efavdb Follow us on twitter for new submission...">

    <meta name="author" content="damienrj">

    <meta name="tags" content="guest">




<!-- Open Graph -->
<meta property="og:site_name" content="EFAVDB"/>
<meta property="og:title" content="Machine learning with wearable sensors"/>
<meta property="og:description" content="A guest post, contributed by Damien Ramunno-Johnson (LinkedIn, bio-sketch) Follow @efavdb Follow us on twitter for new submission..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="./machine-learning-with-wearable-sensors.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2015-01-09 12:34:00-08:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="./author/damienrj.html">
<meta property="article:section" content="Case studies, Guest posts"/>
<meta property="article:tag" content="guest"/>
<meta property="og:image" content="./theme/images/post-bg.jpg">

<!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@efavdb">
    <meta name="twitter:title" content="Machine learning with wearable sensors">
    <meta name="twitter:url" content="./machine-learning-with-wearable-sensors.html">

        <meta name="twitter:image:src" content="./theme/images/post-bg.jpg">

      <meta name="twitter:description" content="A guest post, contributed by Damien Ramunno-Johnson (LinkedIn, bio-sketch) Follow @efavdb Follow us on twitter for new submission...">

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Machine learning with wearable sensors",
  "headline": "Machine learning with wearable sensors",
  "datePublished": "2015-01-09 12:34:00-08:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "damienrj",
    "url": "./author/damienrj.html"
  },
  "image": "./theme/images/post-bg.jpg",
  "url": "./machine-learning-with-wearable-sensors.html",
  "description": "A guest post, contributed by Damien Ramunno-Johnson (LinkedIn, bio-sketch) Follow @efavdb Follow us on twitter for new submission..."
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>
          <li><a href="/" role="presentation">Home</a></li>
          <li><a href="/pages/about.html" role="presentation">About & Consulting</a></li>
          <li><a href="/archives.html" role="presentation">Archive</a></li>
          <li><a href="/tags.html" role="presentation">Tags</a></li>
          <li><a href="/pages/linselect.html" role="presentation">linselect - feature selection</a></li>


    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" >
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="./" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Machine learning with wearable sensors</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="./author/damienrj.html">Damienrj</a>
            | <time datetime="Fri 09 January 2015">Fri 09 January 2015</time>
        </span>
        <!-- TODO : Modified check -->
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <p>A guest post, contributed by Damien Ramunno-Johnson (<a href="https://www.linkedin.com/profile/view?id=60223336&amp;authType=NAME_SEARCH&amp;authToken=LOV_&amp;locale=en_US&amp;trk=tyah2&amp;trkInfo=tarId%3A1420748440448%2Ctas%3Adamien%2Cidx%3A1-1-1">LinkedIn</a>, <a href="http://www.efavdb.com/about">bio-sketch</a>)</p>
<p><a href="http://twitter.com/efavdb">Follow @efavdb</a>  </p>
<p>Follow us on twitter for new submission alerts!</p>
<p><strong>Introduction</strong><br>
Wearable sensors have become increasingly popular over the last few years with the success of smartphones, fitness trackers, and smart watches. All of these devices create a large amount of data that is ideal for machine learning. Two early examples are the FitBit and Jawbone's up band, both of which analyze sensor input to determine how many steps the user has taken, a metric which is helpful for measuring physical activity. There is no reason to stop there: With all of this data available it is also possible to extract more information. For example, fitness trackers coming out now can also analyze your sleep.</p>
<p>In that spirit, I'm going to show here that it is pretty straightforward to make an algorithm that can differentiate between 6 different states.</p>
<ol>
<li>Walking</li>
<li>Walking Upstairs</li>
<li>Walking Downstairs</li>
<li>Sitting</li>
<li>Standing</li>
<li>Laying</li>
</ol>
<p>To do this I am going to use <a href="https://www.python.org/">Python</a>, <a href="http://scikit-learn.org/">Sklearn</a> and <a href="https://plot.ly">Plot.ly</a>. Plot.ly is a wonderful plotting package that makes interactive graphs you can share. The first step is to import all of the relevant packages.</p>
<p><strong>Load packages and source data</strong><br>
For this example, I used one of the datasets available from the <a href="https://archive.ics.uci.edu/ml/datasets/Human+Activity+Recognition+Using+Smartphones">UCI Machine Learning Repository</a>. For this data set 30 subjects were recorded performing activities of daily living (ADL) while carrying a waist-mounted smartphone (Samsung Galaxy II) with embedded inertial sensors. A testing dataset and training dataset are provided. The dataset has 561 features which were created from the sensor data: XYZ acceleration, etc.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="kp">loadtxt</span>  
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span><span class="p">,</span> <span class="n">grid_search</span>  
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">f1_score</span>  
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectPercentile</span><span class="p">,</span> <span class="n">f_classif</span>  
<span class="kn">import</span> <span class="nn">plotly.plotly</span> <span class="k">as</span> <span class="nn">py</span>  
<span class="kn">from</span> <span class="nn">plotly.graph_objs</span> <span class="kn">import</span> <span class="o">*</span>  
</pre></div>


<p>Now that we have loaded all of our packages, it is time to import the data into memory. This data set is not large enough to cause any memory issues, so go ahead and load the whole thing.</p>
<div class="highlight"><pre><span></span><span class="err">data_test = loadtxt(&quot;./Wearable/UCI_HAR_Dataset/test/X_test.txt&quot;)  </span>
<span class="err">label_test=loadtxt(&quot;./Wearable/UCI_HAR_Dataset/test/y_test.txt&quot;)  </span>
<span class="err">data_train = loadtxt(&quot;./Wearable/UCI_HAR_Dataset/train/X_train.txt&quot;)  </span>
<span class="err">label_train = loadtxt(&quot;./Wearable/UCI_HAR_Dataset/train/y_train.txt&quot;)  </span>
</pre></div>


<p><strong>Feature selection</strong><br>
Given that this data set has training and testing data with labels, it makes sense to do supervised machine learning. We have over 500 potential features to use, which is a lot. Let's see if we can get by with fewer features. To do that, we will use SK-learn'€™s SelectKBest to keep the top 20 percent of the features, and then transform the data.</p>
<div class="highlight"><pre><span></span><span class="err">selector = SelectPercentile(f_classif, 20)  </span>
<span class="err">selector.fit(data_train, label_train)  </span>
<span class="err">data_train_transformed = selector.transform(data_train)  </span>
<span class="err">data_test_transformed = selector.transform(data_test)  </span>
</pre></div>


<p><strong>Machine learning</strong><br>
At this point you need to decide which algorithm you want to use. I tried a few of them and got the best results using a <a href="http://scikit-learn.org/stable/modules/svm.html">Support Vector Machine</a> (SVM). SVMs attempt to determine the decision boundary between two classes that is as far away from the data of both classes as possible. In general they work pretty well.</p>
<p>Let's try some parameters and see how good our results are.</p>
<div class="highlight"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="p">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="ss">&quot;rbf&quot;</span><span class="p">,</span> <span class="k">C</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  
<span class="n">clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_train_transformed</span><span class="p">,</span> <span class="n">label_train</span><span class="p">)</span>  
<span class="n">pred</span><span class="o">=</span><span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_test_transformed</span><span class="p">)</span>

<span class="n">print</span> <span class="ss">&quot;Accuracy is %.4f and the f1-score is %.4f &quot;</span> <span class="o">%</span> <span class="p">(</span>  
<span class="n">accuracy_score</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">label_test</span><span class="p">),</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">label_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">))</span>  
</pre></div>


<div class="highlight"><pre><span></span><span class="err">&gt;&gt;Accuracy is 0.8812 and the f1-score is 0.8788  </span>
</pre></div>


<p><strong>Optimization</strong><br>
That's not too bad, but I think we can still optimize our results some more. We could change the parameters manually, or we can automate the task using a <a href="http://scikit-learn.org/stable/modules/generated/sklearn.grid_search.GridSearchCV.html">grid search</a>. This is a handy module that allows you to do a parameter sweep. Below, I set up a sweep using two different kernels and various penalty term values (C) to see if we can raise our accuracy.</p>
<div class="highlight"><pre><span></span><span class="k">parameters</span> <span class="o">=</span> <span class="err">{</span><span class="s1">&#39;kernel&#39;</span><span class="p">:(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;rbf&#39;</span><span class="p">),</span> <span class="s1">&#39;C&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">]</span><span class="err">}</span>  
<span class="n">svr</span> <span class="o">=</span> <span class="n">svm</span><span class="p">.</span><span class="n">SVC</span><span class="p">()</span>  
<span class="n">clf</span> <span class="o">=</span> <span class="n">grid_search</span><span class="p">.</span><span class="n">GridSearchCV</span><span class="p">(</span><span class="n">svr</span><span class="p">,</span> <span class="k">parameters</span><span class="p">)</span>  
<span class="n">clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data_train_transformed</span><span class="p">,</span> <span class="n">label_train</span><span class="p">)</span>  
<span class="n">pred</span><span class="o">=</span><span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data_test_transformed</span><span class="p">)</span>

<span class="n">print</span> <span class="ss">&quot;Accuracy is %.4f and the f1-score is %.4f &quot;</span> <span class="o">%</span> <span class="p">(</span>  
<span class="n">accuracy_score</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">label_test</span><span class="p">),</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">label_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">))</span>  
</pre></div>


<div class="highlight"><pre><span></span><span class="err">&gt;&gt;Accuracy is 0.9430 and the f1-score is 0.9430  </span>
</pre></div>


<p><strong>Visualization</strong><br>
Looks like we are getting pretty good accuracy for using only 20% of the features available to us. You may have also noticed that I am outputting the <a href="http://en.wikipedia.org/wiki/F1_score">F1-Score</a> which is another measure of the accuracy which takes into account the precision and the recall.</p>
<p>Now let's plot some of these data points to see if we can visualize why this is all working. Here, I am using Plot.ly to make the plot. You can make the plots many different ways including converting matplotlib plots into these online plots. If you click on the "play with this data" link at the bottom of the figure (or click <a href="https://plot.ly/~damienrj/104">here</a>) you can see the code used to make the plot.</p>
<p>[iframe src="https://plot.ly/~damienrj/104" width="100%" height="680"]</p>
<p>I picked two of the features to plot, the z acceleration average, and the z acceleration standard deviation. Note, the gravity component of the acceleration was removed and placed into its own feature. Only 3/6 labels are being plotted to make it a little easier to see what is going on. For example, it is easy to see that the walking profile in the top graph differs significantly from those of standing and laying in the bottom two.</p>
<p><strong>Discussion</strong><br>
From the graphs above alone, it would be difficult to differentiate between laying and standing. We might be able to comb through different combinations of features to find a set that is more easily distinguishable, but we are limited by the simple fact that it is hard to visualize data in more than 3 dimensions. If it turns out that more than a handful of features need to be considered simultaneously to separate the different classes, this approach will fail. In contrast, we have seen in our SVM analysis above that it is actually pretty easy to use machine learning to pick out, with high accuracy, a variety of motions from the sensor data. This is a neat application that is currently being applied widely in industry. It illustrates why machine learning is so interesting in general: It allows us to automate data analysis, and apply it to problems where a by-hand, visual analysis is not possible.</p>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Machine learning with wearable sensors&amp;url=./machine-learning-with-wearable-sensors.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=./machine-learning-with-wearable-sensors.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=./machine-learning-with-wearable-sensors.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="./tag/guest.html">guest</a>                </aside>

                <div class="clear"></div>


                </section>


                <aside class="post-nav">
                    <a class="post-nav-next" href="./nba-week-10-summary-week-11-predictions.html">
                        <section class="post-nav-teaser">
                            <i class="ic ic-arrow-left"></i>
                                <h2 class="post-nav-title">NBA week 10 summary, week 11 predictions</h2>
                            <p class="post-nav-excerpt">Fairly good accuracy this past week -- 33/49, or 67.8% overall. The breakdown by point...</p>
                        </section>
                    </a>
                    <a class="post-nav-prev" href="./nba-week-9-summary-week-10-predictions.html">
                        <section class="post-nav-teaser">
                            <i class="ic ic-arrow-right"></i>
                                <h2 class="post-nav-title">NBA week 9 summary, week 10 predictions</h2>
                            <p class="post-nav-excerpt">A poorer than average, but not entirely out of the ordinary performance this week...</p>
                        </section>
                    </a>
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">
        </section>
      </div>
    </footer>
  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script type="text/javascript" src="./theme/js/script.js"></script>

</body>
</html>