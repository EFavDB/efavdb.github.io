<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Jonathan Landy" />

        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content=", Review, Statistics, Theory, " />

<meta property="og:title" content="Normal Distributions "/>
<meta property="og:url" content="./normal-distributions.html" />
<meta property="og:description" content="I review — and provide derivations for — some basic properties of Normal distributions. Topics currently covered: (i) Their normalization, (ii) Samples from a univariate Normal, (iii) Multivariate Normal distributions, (iv) Central limit theorem. Introduction This post contains a running list of properties (with derivations) relating to Normal (Gaussian) distributions. Normal distributions …" />
<meta property="og:site_name" content="EFAVDB" />
<meta property="og:article:author" content="Jonathan Landy" />
<meta property="og:article:published_time" content="2017-05-13T21:48:00-07:00" />
<meta name="twitter:title" content="Normal Distributions ">
<meta name="twitter:description" content="I review — and provide derivations for — some basic properties of Normal distributions. Topics currently covered: (i) Their normalization, (ii) Samples from a univariate Normal, (iii) Multivariate Normal distributions, (iv) Central limit theorem. Introduction This post contains a running list of properties (with derivations) relating to Normal (Gaussian) distributions. Normal distributions …">

        <title>Normal Distributions  · EFAVDB
</title>
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,400,700" rel="stylesheet" type='text/css' />
        <link href="https://fonts.googleapis.com/css?family=Cardo" rel="stylesheet" type='text/css' />        
        <link rel="stylesheet" type="text/css" href="./theme/css/elegant.prod.css" media="screen">
        <link rel="stylesheet" type="text/css" href="./theme/css/custom.css" media="screen">



    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="./"><span class=site-name>EFAVDB</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       .
                                    >Home</a>
                                </li>
                                <li ><a href="./pages/authors.html">Authors</a></li>
                                <li ><a href="./categories.html">Categories</a></li>
                                <li ><a href="./tags.html">Tags</a></li>
                                <li ><a href="./archives.html">Archives</a></li>
                                <li><form class="navbar-search" action="./search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="./normal-distributions.html">
                Normal&nbsp;Distributions
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <p>I review &#8212; and provide derivations for &#8212; some basic properties of Normal distributions. Topics currently covered: (i) Their normalization, (ii) Samples from a univariate Normal, (iii) Multivariate Normal distributions, (iv) Central limit&nbsp;theorem.</p>
<h3>Introduction</h3>
<p><a href="./wp-content/uploads/2017/05/carl-f-gauss-4.jpg"><img alt="carl-f-gauss-4" src="./wp-content/uploads/2017/05/carl-f-gauss-4.jpg"></a></p>
<p>This post contains a running list of properties (with derivations) relating to Normal (Gaussian) distributions. Normal distributions are important for two principal reasons: Their significance a la the central limit theorem and their appearance in saddle point approximations to more general integrals. As usual, the results here assume familiarity with calculus and linear&nbsp;algebra.</p>
<p>Pictured at right is an image of Gauss &#8212; &#8220;Few, but&nbsp;ripe.&#8221;</p>
<h3>Normalization</h3>
<ul>
<li>Consider the integral<br>
<div class="math">\begin{eqnarray} \tag{1}  
    I = \int_{-\infty}^{\infty} e^{-x^2} dx.  
    \end{eqnarray}</div>
<br>
    To evaluate, consider the value of <span class="math">\(I^2\)</span>. This is<br>
<div class="math">\begin{eqnarray}\tag{2}  
    I^2 &amp;=&amp; \int_{-\infty}^{\infty} e^{-x^2} dx \int_{-\infty}^{\infty} e^{-y^2} dy \\  
    &amp;=&amp; \int_0^{\infty} e^{-r^2} 2 \pi r dr = -\pi e^{-r^2} \vert_0^{\infty} = \pi.  
    \end{eqnarray}</div>
<br>
    Here, I have used the usual trick of transforming the integral over the plane to one over polar <span class="math">\((r, \theta)\)</span> coordinates. The result above gives the normalization for the Normal&nbsp;distribution.</li>
</ul>
<h3>Samples from a univariate&nbsp;normal</h3>
<ul>
<li>
<p>Suppose <span class="math">\(N\)</span> independent samples are taken from a Normal distribution. The sample mean is defined as <span class="math">\(\hat{\mu} = \frac{1}{N}\sum x_i\)</span> and the sample variance as <span class="math">\(\hat{S}^2 \equiv \frac{1}{N-1} \sum (x_i - \hat{\mu})^2\)</span>. These two statistics are independent. Further, the former is Normal distributed with variance <span class="math">\(\sigma^2/N\)</span> and the latter is proportional to a <span class="math">\(\chi_{N-1}^2.\)</span></p>
<p><em>Proof:</em> Let the sample be <span class="math">\(\textbf{x} = (x_1, x_2, \ldots, x_N)\)</span>. Then the mean can be written as <span class="math">\(\textbf{x} \cdot \textbf{1}/N\)</span>, the projection of <span class="math">\(\textbf{x}\)</span> along <span class="math">\(\textbf{1}/N\)</span>. Similarly, the sample variance can be expressed as the squared length of <span class="math">\(\textbf{x} - (\textbf{x} \cdot \textbf{1} / N)\textbf{1} = \textbf{x} - (\textbf{x} \cdot \textbf{1} / \sqrt{N})\textbf{1}/\sqrt{N}\)</span>, which is the squared length of <span class="math">\(\textbf{x}\)</span> projected into the space orthogonal to <span class="math">\(\textbf{1}\)</span>. The independence of the <span class="math">\(\{x_i\}\)</span> implies that these two variables are themselves independent, the former Normal and the latter <span class="math">\(\chi^2_{N-1}.\)</span></p>
</li>
<li>
<p>The result above implies that the weight for sample <span class="math">\(\textbf{x}\)</span> can be written as<br>
<div class="math">\begin{eqnarray} \tag{3}  
    p(\textbf{x} \vert \mu, \sigma^2) = \frac{1}{(2 \pi \sigma^2)^{N/2}} \exp\left [ - \frac{1}{2 \sigma^2}\left ( - N (\hat{\mu} - \mu)^2 - (N-1)S^2\right) \right].  
    \end{eqnarray}</div>
</p>
</li>
<li>Aside on sample variance: Given independent samples from any distribution, dividing by <span class="math">\(N-1\)</span> gives an unbiased estimate for the population variance. However, if the samples are not independent (eg, direct trace from <span class="caps">MCMC</span>), this factor is not appropriate: We have<br>
<div class="math">\begin{eqnarray} \nonumber  
    (N-1)E(S^2) = E(\sum (x_i - \overline{x})^2)  
    &amp;=&amp; E(\sum (x_i - \mu)^2 - N ( \overline{x} - \mu)^2 ) \\ \tag{4}  
    &amp;=&amp; N [\sigma^2 - \text{var}(\overline{x})] \label{sample_var}  
    \end{eqnarray}</div>
<br>
    If the samples are independent, the above gives <span class="math">\((N-1) \sigma^2\)</span>. However, if the samples are all the same, <span class="math">\(\text{var}(\overline{x}) = \sigma^2\)</span>, giving <span class="math">\(S^2=0\)</span>. In general, the relationship between the samples determines whether <span class="math">\(S^2\)</span> is biased or&nbsp;not.</li>
<li>From the results above, the quantity<br>
<div class="math">\begin{eqnarray} \label{t-var} \tag{5}  
    (\hat{\mu}- \mu)/(S/\sqrt(N))  
    \end{eqnarray}</div>
<br>
    is the ratio of two independent variables &#8212; the numerator a Normal and the denominator the square root of an independent <span class="math">\(\chi^2_{N-1}\)</span> variable. This quantity follows a universal distribution called the <span class="math">\(t\)</span>-distribution. One can write down closed-form expressions for the <span class="math">\(t\)</span>. For example, when <span class="math">\(N=2\)</span>, you get a Cauchy variable: the ratio of one Normal over the absolute value of another, independent Normal (see above). In general, <span class="math">\(t\)</span>-distributions have power law tails. A key point is that we cannot evaluate (\ref{t-var}) numerically if we do not know <span class="math">\(\mu\)</span>. Nevertheless, we can use the known distribution of the above to specify its likely range. Using this, we can then construct a confidence interval for <span class="math">\(\mu\)</span>.</li>
<li>Consider now a situation where you have two separate Normal distributions. To compare their variances you can take samples from the two and then construct the quantity<br>
<div class="math">\begin{eqnarray}\label{f-var} \tag{6}  
    \frac{S_x / \sigma_x}{ S_y/ \sigma_y}.  
    \end{eqnarray}</div>
<br>
    This is the ratio of two independent <span class="math">\(\chi^2\)</span> variables, resulting in what is referred to as an <span class="math">\(F\)</span>-distributed variable. Like (\ref{t-var}), we often cannot evaluate (\ref{f-var}) numerically. Instead, we use a tabulated cdf of the <span class="math">\(F\)</span>-distribution to derive confidence intervals for the ratio of the two underlying variances. Aside: The <span class="math">\(F\)</span>-distribution arises in the analysis of both <span class="caps">ANOVA</span> and linear regression. Note also that the square of a <span class="math">\(t\)</span>-distributed variable (Normal over the square root of a <span class="math">\(\chi^2\)</span> variable) is <span class="math">\(F\)</span>-distributed.</li>
</ul>
<h3>Multivariate&nbsp;Normals</h3>
<ul>
<li>Consider a set of jointly-distributed variables <span class="math">\(x\)</span> having normal distribution<br>
<div class="math">\begin{eqnarray} \tag{7}  
    p(x) = \sqrt{\frac{ \text{det}(M)} {2 \pi}} \exp \left [- \frac{1}{2} x^T \cdot M \cdot x \right ],  
    \end{eqnarray}</div>
<br>
    with <span class="math">\(M\)</span> a real, symmetric matrix. The correlation of two components is given by<br>
<div class="math">\begin{eqnarray}\tag{8}  
    \langle x_i x_j \rangle = M^{-1}_{ij}.  
    \end{eqnarray}</div>
<br>
<em>Proof:</em> Let<br>
<div class="math">\begin{eqnarray}\tag{9}  
    I = \int dx \exp \left [- \frac{1}{2} x^T \cdot M \cdot x \right ].  
    \end{eqnarray}</div>
<br>
    Then,<br>
<div class="math">\begin{eqnarray}\tag{10}  
    \partial_{M_{ij}} \log I = -\frac{1}{2} \langle x_i x_j \rangle.  
    \end{eqnarray}</div>
<br>
    We can also evaluate this using the normalization of the integral as<br>
<div class="math">\begin{eqnarray} \nonumber  
    \partial_{M_{ij}} \log I &amp;=&amp; - \frac{1}{2} \sum_{\alpha} \frac{1}{\lambda_{\alpha}} \partial_{M_{ij}} \lambda_{\alpha} \\ \nonumber  
    &amp;=&amp; - \frac{1}{2} \sum_{\alpha} \frac{1}{\lambda_{\alpha}} v_{\alpha i } v_{\alpha j} \\  
    &amp;=&amp; - \frac{1}{2} M^{-1}_{ij}. \tag{11}  
    \end{eqnarray}</div>
<br>
    Here, I&#8217;ve used the result <span class="math">\( \partial_{M_{ij}} \lambda_{\alpha} = v_{\alpha i } v_{\alpha j}\)</span>. I give a proof of this next. The last line follows by expressing <span class="math">\(M\)</span> in terms of its eigenbasis. Comparing the last two lines above gives the&nbsp;result.</li>
<li>
<p>Consider a matrix <span class="math">\(M\)</span> having eigenvalues <span class="math">\(\{\lambda_{\alpha}\}\)</span>. The first derivative of <span class="math">\(\lambda_{\alpha}\)</span> with respect to <span class="math">\(M_{ij}\)</span> is given by <span class="math">\(v_{\alpha, i} v_{\alpha, j}\)</span>, where <span class="math">\(v_{\alpha}\)</span> is the unit eigenvector corresponding to the eigenvalue <span class="math">\(\lambda_{\alpha}\)</span>.</p>
<p><em>Proof:</em> The eigenvalue in question is given by<br>
<div class="math">\begin{eqnarray} \tag{12}  
\lambda_{\alpha} = \sum_{ij} v_{\alpha i} M_{ij} v_{\alpha j}.  
\end{eqnarray}</div>
<br>
If we differentiate with respect to <span class="math">\(M_{ab}\)</span>, say, we obtain<br>
<div class="math">\begin{eqnarray} \nonumber  
\partial_{M_{ab}} \lambda_{\alpha} &amp;=&amp; \sum_{ij} \delta_{ia} \delta_{jb} v_{\alpha i} v_{\alpha j} + 2 v_{\alpha i} M_{ij} \partial_{M_{ab}} v_{\alpha j} \\  
&amp;=&amp; v_{\alpha a} v_{\alpha b} + 2 \lambda_{\alpha} v_{\alpha } \cdot \partial_{M_{ab}} v_{\alpha }  
\tag{13}.  
\end{eqnarray}</div>
<br>
The last term above must be zero since the length of <span class="math">\(v_{\alpha }\)</span> is fixed at <span class="math">\(1\)</span>.</p>
</li>
<li>
<p>The conditional distribution. Let <span class="math">\(x\)</span> be a vector of jointly distributed variables of mean zero and covariance matrix <span class="math">\(\Sigma\)</span>. If we segment the variables into two sets, <span class="math">\(x_0\)</span> and <span class="math">\(x_1\)</span>, the distribution of <span class="math">\(x_1\)</span> at fixed <span class="math">\(x_0\)</span> is also normal. Here, we find the mean and covariance. We have<br>
<div class="math">\begin{eqnarray} \label{multivargaucond} \tag{14}  
    p(x) = \mathcal{N} \exp \left [ -\frac{1}{2} x_0^T \Sigma^{-1}_{00} x_0\right] \exp \left [ -\frac{1}{2} \left \{ x_1^T \Sigma^{-1}_{11} x_1 + 2 x_1^T \Sigma^{-1}_{10} x_0 \right \} \right]  
    \end{eqnarray}</div>
<br>
    Here, <span class="math">\(\Sigma^{-1}_{ij}\)</span> refers to the <span class="math">\(i-j\)</span> block of the inverse. To complete the square, we write<br>
<div class="math">\begin{eqnarray} \tag{15}  
    x_1^T \Sigma^{-1}_{11} x_1 + 2 x_1^T \Sigma^{-1}_{10} x_0 + c = (x_1^T + a) \Sigma^{-1}_{11} ( x_1 + a).  
    \end{eqnarray}</div>
<br>
    Comparing both sides, we find<br>
<div class="math">\begin{eqnarray} \tag{16}  
    x_1^T \Sigma^{-1}_{10} x_0 = x_1^T \Sigma^{-1}_{11} a  
    \end{eqnarray}</div>
<br>
    This holds for any value of <span class="math">\(x_1^T\)</span>, so we must have<br>
<div class="math">\begin{eqnarray}\tag{17}  
    a = \left( \Sigma^{-1}_{11} \right)^{-1} \Sigma^{-1}_{10} x_0 .  
    \end{eqnarray}</div>
<br>
    Plugging the last few results into (\ref{multivargaucond}), we obtain<br>
<div class="math">\begin{eqnarray} \nonumber  
    p(x) = \mathcal{N} \exp \left [ -\frac{1}{2} x_0^T \left( \Sigma^{-1}_{00} -  
    \Sigma^{-1}_{01} \left( \Sigma^{-1}_{11} \right)^{-1} \Sigma^{-1}_{10} \right) x_0\right] \\ \times  
    \exp \left [ -\frac{1}{2} \left (x_1 + \left( \Sigma^{-1}_{11} \right)^{-1} \Sigma^{-1}_{10} x_0 \right) \Sigma^{-1}_{11} \left (x_1 + \left( \Sigma^{-1}_{11} \right)^{-1} \Sigma^{-1}_{10} x_0 \right) \right ] \tag{18} \label{multivargaucondfix}  
    \end{eqnarray}</div>
<br>
    This shows that <span class="math">\(x_0\)</span> and <span class="math">\(x_1 + \left( \Sigma^{-1}_{11} \right)^{-1} \Sigma^{-1}_{10} x_0 $ are independent. This formula also shows that the average value of $x_1\)</span> shifts at fixed <span class="math">\(x_0\)</span>,<br>
<div class="math">\begin{eqnarray}\tag{19}  
    \langle x_1 \rangle = \langle x_1 \rangle_0 - \left( \Sigma^{-1}_{11} \right)^{-1} \Sigma^{-1}_{10} x_0.  
    \end{eqnarray}</div>
<br>
    With some work, we can rewrite this as<br>
<div class="math">\begin{eqnarray} \tag{20}  
    \langle x_1 \rangle = \langle x_1 \rangle_0 + \Sigma_{10} \frac{1}{\Sigma_{00}}x_0.  
    \end{eqnarray}</div>
<br>
    There are two ways to prove this equivalent form holds. One is to make use of the expression for the inverse of a block matrix. The second is to note that the above is simply the linear response to a shift in <span class="math">\(x_0\)</span> &#8212; see post on linear&nbsp;regression.</p>
</li>
<li>If we integrate over <span class="math">\(x_1\)</span> in (\ref{multivargaucondfix}), we obtain the distribution for <span class="math">\(x_0\)</span>. This is<br>
<div class="math">\begin{eqnarray} \tag{21}  
    p(x_0) = \mathcal{N} \exp \left [ -\frac{1}{2} x_0^T \left( \Sigma^{-1}_{00} -  
    \Sigma^{-1}_{01} \left( \Sigma^{-1}_{11} \right)^{-1} \Sigma^{-1}_{10} \right) x_0\right]  
    \end{eqnarray}</div>
<br>
    The block-diagonal inverse theorem can be used to show that this is equivalent to<br>
<div class="math">\begin{eqnarray} \tag{22}  
    p(x_0) = \mathcal{N} \exp \left [ -\frac{1}{2} x_0^T \left( \Sigma_{00} \right)^{-1} x_0\right]  
    \end{eqnarray}</div>
<br>
    Another way to see this is correct is to make use of the fact that the coefficient matrix in the normal is the inverse of the correlation matrix. We know that after integrating out the values of <span class="math">\(x_1\)</span>, we remain normal, and the covariance matrix will simply be given by that for <span class="math">\(x_0\)</span>.</li>
<li>The covariance of the <span class="caps">CDF</span> transform in multivariate case &#8212; a result needed for fitting Gaussian Copulas to data: Let <span class="math">\(x_1, x_2\)</span> be jointly distributed Normal variables with covariance matrix<br>
<div class="math">\begin{eqnarray}  
    C = \left( \begin{array}{cc}  
    1 &amp; \rho \\  
    \rho &amp; 1  
    \end{array} \right)  
    \end{eqnarray}</div>
<br>
    The <span class="caps">CDF</span> transform of <span class="math">\(x_i\)</span> is defined as<br>
<div class="math">\begin{eqnarray}  
    X_i \equiv \frac{1}{\sqrt{2 \pi}} \int_{-\infty}^{x_i} \exp\left( -\frac{\tilde{x}_i^2}{2} \right)d\tilde{x}_i.  
    \end{eqnarray}</div>
<br>
    Here, we&#8217;ll calculate the covariance of <span class="math">\(X_1\)</span> and <span class="math">\(X_2\)</span>. Up to a constant that does not depend on <span class="math">\(\rho\)</span>, this is given by the integral<br>
<div class="math">\begin{eqnarray}  
    J \equiv \frac{1}{\sqrt{(2 \pi)^2 \text{det} C}} \int d\vec{x} \exp\left( -\frac{1}{2} \vec{x} \cdot C^{-1} \cdot \vec{x} \right)  
    \frac{1}{2 \pi} \int_{-\infty}^{x_1}\int_{-\infty}^{x_2} \exp\left( -\frac{\tilde{x}_1^2}{2} -\frac{\tilde{x}_2^2}{2} \right)d\tilde{x}_1 d\tilde{x}_2.  
    \end{eqnarray}</div>
<br>
    To progress, we first write<br>
<div class="math">\begin{eqnarray}  
    \exp\left( -\frac{\tilde{x}_i^2}{2} \right ) = \frac{1}{\sqrt{2\pi }}\int \exp \left (- \frac{1}{2} k_i^2 + i k \tilde{x}_i \right )  
    \end{eqnarray}</div>
<br>
    We will substitute this equation into the prior line and then integrate over the <span class="math">\(\tilde{x}_i\)</span> using the result<br>
<div class="math">\begin{eqnarray}  
    \int_{-\infty}^{x_i} \exp \left ( i k \tilde{x}_i \right ) d \tilde{x}_i = \frac{e^{i k_i x_i}}{i k_i}.  
    \end{eqnarray}</div>
<br>
    This gives<br>
<div class="math">\begin{eqnarray}  
    J = \frac{-1}{(2 \pi)^3 \sqrt{\text{det} C} } \int_{k_1} \int_{k_2} \frac{e^{-\frac{1}{2} (k_1^2 + k_2^2)}}{k_1 k_2}  
    \int d\vec{x} \exp\left( -\frac{1}{2} \vec{x} \cdot C^{-1} \cdot \vec{x} + i \vec{k} \cdot \vec{x} \right)  
    \end{eqnarray}</div>
<br>
    The integral on <span class="math">\(\vec{x}\)</span> can now be carried out by completing the square. This gives<br>
<div class="math">\begin{eqnarray}  
    J = \frac{1}{(2 \pi)^2} \int_{k_1} \int_{k_2} \frac{1}{k_1 k_2}  
    \exp\left( -\frac{1}{2} \vec{k} \cdot (C + I) \cdot \vec{k} \right)  
    \end{eqnarray}</div>
<br>
    We now differentiate with respect to <span class="math">\(\rho\)</span> to get rid of the <span class="math">\(k_1 k_2\)</span> in the denominator. This gives<br>
<div class="math">\begin{eqnarray} \nonumber  
    \partial_{\rho} J &amp;=&amp; \frac{1}{(2 \pi)^2} \int_{k_1} \int_{k_2}  
    \exp\left( -\frac{1}{2} \vec{k} \cdot (C + I) \cdot \vec{k} \right) \\ \nonumber  
    &amp;=&amp; \frac{1}{2 \pi } \frac{1}{\sqrt{\text{det}(C + I)}} \\  
    &amp;=&amp; \frac{1}{4 \pi } \frac{1}{\sqrt{1 - \frac{\rho^2}{4}}}.  
    \end{eqnarray}</div>
<br>
    The last step is to integrate with respect to <span class="math">\(\rho\)</span>, but we will now switch back to the original goal of calculating the covariance of the two <span class="caps">CDF</span> transforms, <span class="math">\(P\)</span>, rather than <span class="math">\(J\)</span> itself. At <span class="math">\(\rho = 0\)</span>, we must have <span class="math">\(P(\rho=0) = 0\)</span>, since the transforms will also be uncorrelated in this limit. This gives<br>
<div class="math">\begin{eqnarray} \nonumber  
    P &amp;=&amp; \int_0^{\rho} \frac{1}{4 \pi } \frac{1}{\sqrt{1 - \frac{\rho^2}{4}}} d \rho \\  
    &amp;=&amp; \frac{1}{2 \pi } \sin^{-1} \left( \frac{\rho}{2} \right). \tag{23}  
    \end{eqnarray}</div>
<br>
    Using a similar calculation, we find that the diagonal terms of the <span class="caps">CDF</span> covariance matrix are <span class="math">\(1/12\)</span>.</li>
</ul>
<h3>Central Limit&nbsp;Theorem</h3>
<ul>
<li>
<p>Let <span class="math">\(x_1, x_2, \ldots, x_N\)</span> be <span class="caps">IID</span> random variables with an mgf that exists near <span class="math">\(0\)</span>. Let <span class="math">\(E(x_i) = \mu\)</span> and <span class="math">\(\text{var}(x_i) = \sigma^2\)</span>. Then the variable <span class="math">\(\frac{\overline{x} - \mu}{\sigma / \sqrt{N}}\)</span> approaches standard normal as <span class="math">\(N \to \infty\)</span>.</p>
<p><em>Proof:</em> Let <span class="math">\(y_i =\frac{x_i - \mu}{\sigma}\)</span>. Then,<br>
<div class="math">\begin{eqnarray}\tag{24}  
\tilde{y} \equiv \frac{\overline{x} - \mu}{\sigma / \sqrt{N}} = \frac{1}{\sqrt{N}} \sum_i y_i.  
\end{eqnarray}</div>
<br>
Using the fact that the mgf of a sum of independent variables is given by the product of their mgfs, the quantity at left is<br>
<div class="math">\begin{eqnarray} \tag{25}  
m_{\tilde{y}}(t) = \left [ m_{y}\left (\frac{t}{\sqrt{N}} \right) \right]^n.  
\end{eqnarray}</div>
<br>
We now expand the term in brackets using a Taylor series, obtaining<br>
<div class="math">\begin{eqnarray} \tag{26}  
m_{\tilde{y}}(t) = \left [1 + \frac{t^2}{2 N } + O\left (\frac{t^3}{ N^{3/2}} \right) \right]^N \to \exp\left ( \frac{t^2}{2} \right),  
\end{eqnarray}</div>
<br>
where the latter form is the fixed <span class="math">\(t\)</span> limit as <span class="math">\(N \to \infty\)</span>. This is the mgf for a <span class="math">\(N(0,1)\)</span> variable, proving the&nbsp;result.</p>
</li>
<li>
<p>One can get a sense of the accuracy of the normal approximation at fixed <span class="math">\(N\)</span> through consideration of higher moments. For example, if we have an even distribution with mgf <span class="math">\(1 + x^2 /2 + (1 + \kappa^{\prime}) x^4 / 8 + \ldots\)</span>. Then the mgf for the scaled average above will be<br>
<div class="math">\begin{eqnarray}\nonumber  
    m_{\tilde{y}} &amp;=&amp; \left [1 + \frac{t^2}{2 N } + \frac{(1 + \kappa^{\prime}) t^4}{8 N^2 } + \ldots \right]^N \\  
    &amp;=&amp; 1 + \frac{t^2}{2} + \left (1 + \frac{\kappa^{\prime}}{ N } \right) \frac{t^4}{8} + \ldots \tag{27}  
    \end{eqnarray}</div>
<br>
    This shows that the deviation in the kurtosis away from its <span class="math">\(N(0,1)\)</span> value decays like <span class="math">\(1/N\)</span>.</p>
</li>
</ul>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>


             
 
                <p id="post-share-links">
    Like this post?  Share on:
    <a href="https://twitter.com/intent/tweet?text=Normal%C2%A0Distributions&url=http%3A//efavdb.github.io/normal-distributions.html" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
    ❄
    <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A//efavdb.github.io/normal-distributions.html" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
    ❄
    <a href="mailto:?subject=Normal%C2%A0Distributions&amp;body=http%3A//efavdb.github.io/normal-distributions.html" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>
    </p>

                <hr />
    <div class="author_blurb">
        <a href="" target="_blank" rel="nofollow noopener noreferrer">
            <img src=/wp-content/uploads/2014/12/JonathanLinkedIn.jpg alt="Jonathan Landy Avatar" title="Jonathan Landy">
            <span class="author_name">Jonathan Landy</span>
        </a>
        Jonathan grew up in the midwest and then went to school at Caltech and UCLA. Following this, he did two postdocs, one at UCSB and one at UC Berkeley.  His academic research focused primarily on applications of statistical mechanics, but his professional passion has always been in the mastering, development, and practical application of slick math methods/tools. He worked as a data-scientist at Square for four years and is now working on a quantitative investing startup.
    </div>

            






<section>
    <h6 style="display:none;">Comments</h6>
    <p id="comment-message"> </p>

    <div class="accordion" id="accordion2">
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle disqus-comment-count comment-count"
                   data-toggle="collapse"
                   data-parent="#accordion2"
                   data-disqus-identifier="./normal-distributions.html"
                   href="./normal-distributions.html#comment_thread"
                   id="comment-accordion-toggle">
                    Comments
                </a>
            </div>
            <div id="comment_thread" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="comments">
                        <div id="disqus_thread"></div>
                        <script>
    var disqus_shortname = 'EFAVDB';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());

    var disqus_identifier = './normal-distributions.html';
    var disqus_url = './normal-distributions.html';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>

<noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

            <hr/>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="./model-auc-depends-on-test-set-difficulty.html" title="Previous: Model AUC depends on test set difficulty">Model AUC depends on test set difficulty</a></li>
                <li class="next-article"><a href="./logistic-regression.html" title="Next: Logistic Regression">Logistic Regression</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2017-05-13T21:48:00-07:00">May 13, 2017</time>
            <h4>Category</h4>
            <a class="category-link" href="./categories.html#review-statistics-theory-ref">Review, Statistics, Theory</a>
<h4>Contact</h4>
<div id="sidebar-social-link">
    <a href="https://twitter.com/efavdb" title="" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="Twitter" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1da1f3"/><path fill="#fff" d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
    </a>
</div>
            





            





        </section>
</div>
</article>
                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>

    <div>
        <span class="site-name">EFAVDB</span> - Everybody's Favorite Data Blog
    </div>



    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>