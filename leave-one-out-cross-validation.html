<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Leave-one-out cross-validation</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="./leave-one-out-cross-validation.html" rel="canonical" />
  <!-- Feed -->

  <link href="./theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="./theme/css/code_blocks/github.css" rel="stylesheet">


  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->



    <meta name="description" content="This will be the first of a series of short posts relating to subject matter discussed in the text, "An Introduction to Statistical...">

    <meta name="author" content="Jonathan Landy">





<!-- Open Graph -->
<meta property="og:site_name" content="EFAVDB"/>
<meta property="og:title" content="Leave-one-out cross-validation"/>
<meta property="og:description" content="This will be the first of a series of short posts relating to subject matter discussed in the text, "An Introduction to Statistical..."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="./leave-one-out-cross-validation.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2015-08-01 16:08:00-07:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="./author/jonathan-landy.html">
<meta property="article:section" content="Methods, Theory"/>
<meta property="og:image" content="./theme/images/post-bg.jpg">

<!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@efavdb">
    <meta name="twitter:title" content="Leave-one-out cross-validation">
    <meta name="twitter:url" content="./leave-one-out-cross-validation.html">

        <meta name="twitter:image:src" content="./theme/images/post-bg.jpg">

      <meta name="twitter:description" content="This will be the first of a series of short posts relating to subject matter discussed in the text, "An Introduction to Statistical...">

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Leave-one-out cross-validation",
  "headline": "Leave-one-out cross-validation",
  "datePublished": "2015-08-01 16:08:00-07:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Jonathan Landy",
    "url": "./author/jonathan-landy.html"
  },
  "image": "./theme/images/post-bg.jpg",
  "url": "./leave-one-out-cross-validation.html",
  "description": "This will be the first of a series of short posts relating to subject matter discussed in the text, "An Introduction to Statistical..."
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>
          <li><a href="/" role="presentation">Home</a></li>
          <li><a href="/pages/about.html" role="presentation">About & Consulting</a></li>
          <li><a href="/archives.html" role="presentation">Archive</a></li>
          <li><a href="/tags.html" role="presentation">Tags</a></li>
          <li><a href="/pages/linselect.html" role="presentation">linselect - feature selection</a></li>


    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" >
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="./" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Leave-one-out cross-validation</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="./author/jonathan-landy.html">Jonathan Landy</a>
            | <time datetime="Sat 01 August 2015">Sat 01 August 2015</time>
        </span>
        <!-- TODO : Modified check -->
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <p>This will be the first of a series of short posts relating to subject matter discussed in the text, <a href="http://www-bcf.usc.edu/~gareth/ISL/">"An Introduction to Statistical Learning"</a>. This is an interesting read, but it often skips over statement proofs -- that's where this series of posts comes in! Here, I consider the content of Section 5.1.2: This gives a lightning-quick "short cut" method for evaluating a regression's leave-one-out cross-validation error. The method is applicable to any least-squares linear fit.</p>
<h3>Introduction: Leave-one-out cross-validation</h3>
<p>When carrying out a <a href="https://en.wikipedia.org/wiki/Regression_analysis">regression analysis</a>, one is often interested in two types of error measurement. The first is the training set error and the second is the generalization error. The former relates to how close the regression is to the data being fit. In contrast, the generalization error relates to how accurate the model will be when applied to other points. The latter is of particular interest whenever the regression will be used to make predictions on new points.</p>
<p><a href="https://en.wikipedia.org/wiki/Cross-validation_(statistics)">Cross-validation</a> provides one method for estimating generalization errors. The approach centers around splitting the training data available into two sets, <em>a cross-validation training set</em> and <em>cross-validation test set</em>. The first of these is used for training a regression model. Its accuracy on the test set then provides a generalization error estimate. Here, we focus on a special form of cross-validation, called <em>leave-one-out cross-validation</em> (LOOCV). In this case, we pick only one point as the test set. We then build a model on all the remaining, complementary points, and evaluate its error on the single-point held out. A generalization error estimate is obtained by repeating this procedure for each of the training points available, averaging the results.</p>
<p>LOOCV can be computationally expensive because it generally requires one to construct many models -- equal in number to the size of the training set. However, for the special case of least-squares polynomial regression we have the following "short cut" identity:<br>
</p>
<div class="math">$$ \label{theorem} \tag{1}  
\sum_i \left ( \tilde{y}_i - y_i\right)^2 = \sum_i \left ( \frac{\hat{y}_i - y_i}{1 - h_i}\right)^2.  
$$</div>
<p><br>
Here, <span class="math">\(y_i\)</span> is the actual label value of training point <span class="math">\(i\)</span>, <span class="math">\(\tilde{y}_i\)</span> is the value predicted by the cross-validation model trained on all points except <span class="math">\(i\)</span>, <span class="math">\(\hat{y}_i\)</span> is the value predicted by the regression model trained on all points (including point <span class="math">\(i\)</span>), and <span class="math">\(h_i\)</span> is a function of the coordinate <span class="math">\(\vec{x}_i\)</span> -- this is defined further below. Notice that the left side of (\ref{theorem}) is the LOOCV sum of squares error (the quantity we seek), while the right can be evaluated given only the model trained on the full data set. Fantastically, this allows us to evaluate the LOOCV error using only a single regression!</p>
<h3>Statement proof</h3>
<p>Consider the LOOCV step where we construct a model trained on all points except training example <span class="math">\(k\)</span>. Using a linear model of form <span class="math">\(\tilde{y}(\vec{x}) \equiv \vec{x}^T \cdot \vec{\beta}_k\)</span> -- with <span class="math">\(\vec{\beta}_k\)</span> a coefficient vector -- the sum of squares that must be minimized is<br>
</p>
<div class="math">$$\tag{2} \label{error_sum}  
J_k \equiv \sum_{i \not = k} \left ( \tilde{y}_i - y_i \right)^2 = \sum_{i \not = k} \left (\vec{x}^T_i \cdot \vec{\beta}_k - y_i \right)^2.  
$$</div>
<p><br>
Here, we're using a subscript <span class="math">\(k\)</span> on <span class="math">\(\vec{\beta}_k\)</span> to highlight the fact that the above corresponds to the case where example <span class="math">\(k\)</span> is held out. We minimize (\ref{error_sum}) by taking the gradient with respect to <span class="math">\(\vec{\beta}_k\)</span>. Setting this to zero gives the equation<br>
</p>
<div class="math">$$\tag{3}  
\left( \sum_{i \not = k} \vec{x}_i \vec{x}_i^T \right) \cdot \vec{\beta}_k = \sum_{i \not = k} y_i \vec{x}_i.  
$$</div>
<p><br>
Similarly, the full model (trained on all points) coefficient vector <span class="math">\(\vec{\beta}\)</span> satisfies<br>
</p>
<div class="math">$$\tag{4} \label{full_con}  
\left( \sum_{i} \vec{x}_i \vec{x}_i^T \right) \cdot \vec{\beta} \equiv M \cdot \vec{\beta} = \sum_{i} y_i \vec{x}_i.  
$$</div>
<p><br>
Combining the prior two equations gives,<br>
</p>
<div class="math">$$\tag{5}  
\left (M - \vec{x}_k \vec{x}_k^T \right) \cdot \vec{\beta}_k = \left (\sum_{i} y_i \vec{x}_i\right) - y_k \vec{x}_k = M\cdot \vec{\beta} - y_k \vec{x}_k.  
$$</div>
<p><br>
Using the definition of <span class="math">\(\tilde{y}_k\)</span>, rearrangement of the above leads to the identity<br>
</p>
<div class="math">$$\tag{6}  
M \cdot \left ( \vec{\beta}_k - \vec{\beta} \right) = \left (\tilde{y}_k - y_k \right) \vec{x}_k.  
$$</div>
<p><br>
Left multiplication by <span class="math">\(\vec{x}_k^T M^{-1}\)</span> gives,<br>
</p>
<div class="math">$$\tag{7}  
\tilde{y}_k - \hat{y}_k = \left( \tilde{y}_k - y_k\right) - \left( \hat{y}_k - y_k \right) = \vec{x}_k^T M^{-1} \vec{x}_k \left (\tilde{y}_k - y_k \right).  
$$</div>
<p><br>
Finally, combining like-terms, squaring, and summing gives<br>
</p>
<div class="math">$$\tag{8}  
\sum_k \left (\tilde{y}_k - y_k \right) ^2 = \sum_k \left (\frac{\hat{y}_k - y_k}{1 -\vec{x}_k^T M^{-1} \vec{x}_k } \right)^2.  
$$</div>
<p><br>
This is (\ref{theorem}), where we now see the parameter <span class="math">\(h_k \equiv \vec{x}_k^T M^{-1} \vec{x}_k\)</span>. This is referred to as the "leverage" of <span class="math">\(\vec{x}_k\)</span> in the text. Notice also that <span class="math">\(M\)</span> is proportional to the correlation matrix of the <span class="math">\(\{\vec{x}_i\}\)</span>. <span class="math">\(\blacksquare\)</span></p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Leave-one-out cross-validation&amp;url=./leave-one-out-cross-validation.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=./leave-one-out-cross-validation.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=./leave-one-out-cross-validation.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>


                <div class="clear"></div>

                <aside class="post-author">


                        <figure class="post-author-avatar">
                            <img src=".//wp-content/uploads/2014/12/JonathanLinkedIn.jpg" alt="Jonathan Landy" />
                        </figure>
                    <div class="post-author-bio">
                        <h4 class="post-author-name"><a href="./author/jonathan-landy.html">Jonathan Landy</a></h4>
                            <p class="post-author-about">Jonathan grew up in the midwest and then went to school at Caltech and UCLA. Following this, he did two postdocs, one at UCSB and one at UC Berkeley.  His academic research focused primarily on applications of statistical mechanics, but his professional passion has always been in the mastering, development, and practical application of slick math methods/tools. He worked as a data-scientist at Square for four years and is now working on a quantitative investing startup.</p>
                        <!-- Social linkes in alphabet order. -->
                    </div>
                    <div class="clear"></div>
                </aside>

                </section>


                <aside class="post-nav">
                    <a class="post-nav-next" href="./build-a-web-scraper-lit-search.html">
                        <section class="post-nav-teaser">
                            <i class="ic ic-arrow-left"></i>
                                <h2 class="post-nav-title">Build a web scraper for a literature search - from soup to nuts</h2>
                            <p class="post-nav-excerpt">Code, references, and examples of this project are on Github. In this post, I'll...</p>
                        </section>
                    </a>
                    <a class="post-nav-prev" href="./predicting-san-francisco-crimes.html">
                        <section class="post-nav-teaser">
                            <i class="ic ic-arrow-right"></i>
                                <h2 class="post-nav-title">Machine learning to predict San Francisco crime</h2>
                            <p class="post-nav-excerpt">In today's post, we document our submission to the recent Kaggle competition aimed at...</p>
                        </section>
                    </a>
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
      <div class="inner">
        <section class="credits">
        </section>
      </div>
    </footer>
  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script type="text/javascript" src="./theme/js/script.js"></script>

</body>
</html>